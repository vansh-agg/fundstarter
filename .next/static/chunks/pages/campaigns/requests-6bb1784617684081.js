(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[73],{8216:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/campaigns/requests",function(){return s(3510)}])},3510:function(e,r,s){"use strict";s.r(r),s.d(r,{default:function(){return j}});var n=s(7568),t=s(7582),c=s(5893),i=s(7294),u=s(2469),a=s(6215),o=s(5927),l=s(8005),d=s(967),p=s(1508),h=s(4148);function x(e){var r=(0,i.useState)(!1),s=r[0],u=r[1],l=(0,i.useState)(!1),x=l[0],j=l[1],f=o.Z.Row,m=o.Z.Cell,Z=e.request.approvalcount>e.approvers/2,q=function(){var r=(0,n.Z)((function(){var r,s;return(0,t.__generator)(this,(function(n){switch(n.label){case 0:return u(!0),[4,p.Z.eth.getAccounts()];case 1:r=n.sent(),s=(0,h.Z)(e.address),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,s.methods.approverequest(e.id).send({from:r[0]})];case 3:return n.sent(),[3,5];case 4:return n.sent(),u(!1),[3,5];case 5:return u(!1),a.Router.replaceRoute("/campaigns/".concat(e.address,"/requests")),[2]}}))}));return function(){return r.apply(this,arguments)}}(),v=function(){var r=(0,n.Z)((function(){var r,s;return(0,t.__generator)(this,(function(n){switch(n.label){case 0:return j(!0),[4,p.Z.eth.getAccounts()];case 1:r=n.sent(),s=(0,h.Z)(e.address),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,s.methods.finalizerequest(e.id).send({from:r[0]})];case 3:return n.sent(),[3,5];case 4:return n.sent(),j(!1),[3,5];case 5:return j(!1),a.Router.replaceRoute("/campaigns/".concat(e.address,"/requests")),[2]}}))}));return function(){return r.apply(this,arguments)}}();return(0,c.jsxs)(f,{disabled:e.request.complete,positive:Z&&!e.request.complete,children:[(0,c.jsx)(m,{children:e.id}),(0,c.jsx)(m,{children:e.request.description}),(0,c.jsx)(m,{children:p.Z.utils.fromWei(e.request.value,"ether")}),(0,c.jsx)(m,{children:e.request.recipient}),(0,c.jsxs)(m,{children:[e.request.approvalcount,"/",e.approvers]}),(0,c.jsx)(m,{children:e.request.complete?"FINALIZED":(0,c.jsx)(d.Z,{color:"green",basic:!0,onClick:q,loading:s,children:"Approve"})}),(0,c.jsx)(m,{children:e.request.complete?"FINALIZED":(0,c.jsx)(d.Z,{color:"teal",basic:!0,onClick:v,loading:x,children:"Finalize"})})]})}function j(e){var r=o.Z.Header,s=o.Z.Row,n=o.Z.HeaderCell,t=o.Z.Body;return(0,c.jsxs)(u.Z,{children:[(0,c.jsxs)(l.Z,{children:[(0,c.jsx)(l.Z.Column,{width:7,children:(0,c.jsx)(a.Link,{route:"/campaigns/".concat(e.address),children:(0,c.jsx)("a",{children:(0,c.jsx)(d.Z,{primary:!0,style:{marginBottom:"50px"},children:"Back"})})})}),(0,c.jsx)(l.Z.Column,{width:4,children:(0,c.jsx)("h3",{children:"Requests Index"})}),(0,c.jsx)(l.Z.Column,{width:5,children:(0,c.jsx)(a.Link,{route:"/campaigns/".concat(e.address,"/requests/new"),children:(0,c.jsx)("a",{children:(0,c.jsx)(d.Z,{primary:!0,floated:"right",style:{marginBottom:"50px"},children:"Add request"})})})})]}),(0,c.jsxs)(o.Z,{children:[(0,c.jsx)(r,{children:(0,c.jsxs)(s,{children:[(0,c.jsx)(n,{children:"ID"}),(0,c.jsx)(n,{children:"Description"}),(0,c.jsx)(n,{children:"Amount"}),(0,c.jsx)(n,{children:"Recipient"}),(0,c.jsx)(n,{children:"Approval Count"}),(0,c.jsx)(n,{children:"Approve"}),(0,c.jsx)(n,{children:"Finalize"})]})}),(0,c.jsx)(t,{children:e.requests.map((function(r,s){return(0,c.jsx)(x,{id:s,request:r,address:e.address,approvers:e.approverscount},s)}))})]}),(0,c.jsxs)("div",{style:{marginTop:"30px",fontSize:"16px"},children:["Found ",e.requestcount," requests "]})]})}j.getInitialProps=function(){var e=(0,n.Z)((function(e){var r,s,n,c,i;return(0,t.__generator)(this,(function(t){switch(t.label){case 0:return r=e.query.address,[4,(s=(0,h.Z)(r)).methods.getrequestcount().call()];case 1:return n=t.sent(),[4,s.methods.approvercount().call()];case 2:return c=t.sent(),[4,Promise.all(Array(parseInt(n)).fill().map((function(e,r){return s.methods.requests(r).call()})))];case 3:return i=t.sent(),[2,{address:r,requests:i,requestcount:n,approverscount:c}]}}))}));return function(r){return e.apply(this,arguments)}}()}},function(e){e.O(0,[774,543,396,714,494,269,663,888,179],(function(){return r=8216,e(e.s=r);var r}));var r=e.O();_N_E=r}]);